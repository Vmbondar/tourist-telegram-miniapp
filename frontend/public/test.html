<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .success {
            background-color: #d4edda;
            color: #155724;
        }
        .error {
            background-color: #f8d7da;
            color: #721c24;
        }
        .info {
            background-color: #d1ecf1;
            color: #0c5460;
        }
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üîç API Test Page</h1>
    <p>–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Backend API</p>

    <button onclick="testAPI()">–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç</button>
    <button onclick="testCities()">–¢–µ—Å—Ç Cities</button>
    <button onclick="testAttractions()">–¢–µ—Å—Ç Attractions</button>

    <div id="results"></div>

    <script>
        const API_URL = 'https://acrobat-weights-grow-von.trycloudflare.com/api/v1';

        function addResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `test-result ${type}`;
            div.innerHTML = message;
            document.getElementById('results').appendChild(div);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        async function testAPI() {
            clearResults();
            addResult('üöÄ –ù–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...', 'info');

            // Test 1: Health check
            try {
                addResult('–¢–µ—Å—Ç 1: Health Check...', 'info');
                const response = await fetch('https://acrobat-weights-grow-von.trycloudflare.com/health');
                const data = await response.json();
                addResult(`‚úÖ Health Check: ${JSON.stringify(data)}`, 'success');
            } catch (error) {
                addResult(`‚ùå Health Check failed: ${error.message}`, 'error');
            }

            // Test 2: Cities
            try {
                addResult('–¢–µ—Å—Ç 2: Cities API...', 'info');
                const response = await fetch(`${API_URL}/cities`);
                const data = await response.json();
                addResult(`‚úÖ Cities API: –ü–æ–ª—É—á–µ–Ω–æ ${data.total} –≥–æ—Ä–æ–¥–æ–≤`, 'success');
                addResult(`<pre>${JSON.stringify(data, null, 2)}</pre>`, 'info');
            } catch (error) {
                addResult(`‚ùå Cities API failed: ${error.message}`, 'error');
            }

            // Test 3: Attractions
            try {
                addResult('–¢–µ—Å—Ç 3: Attractions API...', 'info');
                const response = await fetch(`${API_URL}/attractions?city_id=1&page=1&page_size=3`);
                const data = await response.json();
                addResult(`‚úÖ Attractions API: –ü–æ–ª—É—á–µ–Ω–æ ${data.items.length} –¥–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π`, 'success');
                addResult(`<pre>${JSON.stringify(data, null, 2)}</pre>`, 'info');
            } catch (error) {
                addResult(`‚ùå Attractions API failed: ${error.message}`, 'error');
            }
        }

        async function testCities() {
            clearResults();
            try {
                const response = await fetch(`${API_URL}/cities`);
                const data = await response.json();
                addResult(`‚úÖ –ì–æ—Ä–æ–¥–æ–≤: ${data.total}`, 'success');
                data.items.forEach(city => {
                    addResult(`- ${city.name} (ID: ${city.id})`, 'info');
                });
            } catch (error) {
                addResult(`‚ùå Error: ${error.message}`, 'error');
            }
        }

        async function testAttractions() {
            clearResults();
            try {
                const response = await fetch(`${API_URL}/attractions?city_id=1&page=1&page_size=10`);
                const data = await response.json();
                addResult(`‚úÖ –î–æ—Å—Ç–æ–ø—Ä–∏–º–µ—á–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π: ${data.items.length}`, 'success');
                data.items.forEach(attr => {
                    addResult(`- ${attr.name} (${attr.category})`, 'info');
                });
            } catch (error) {
                addResult(`‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Auto-run on load
        window.addEventListener('load', () => {
            addResult('–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.', 'info');
        });
    </script>
</body>
</html>
